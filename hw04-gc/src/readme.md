# Последовательность шагов по оптимизации приложения

Первым, очевидным шагом, озвученным ещё на лекции, являлась замена в коде программы Integer на int.
Это дало примерно восьмикратный рост производительности программы.  
Дальнейшая оптимизация касалась работы jvm, без вмешательства в байт-код программы.  
Специфика программы заключается в отсутствии требований к latency и в то же время - в требовании повышенного throughput.
Для повышения последнего был заменён сборщик мусора с G1GC на ParallelGC, максимальная производительность которого
была достигнута на 4 рабочих потоках (на тестовой машине 4 ядра).  
Судя по полученным значениям замеров, по-умолчанию он также запускался с четырьмя потоками.  
Замена сборщика  мусора дала повышение производительности ещё чуть меньше, чем в 2 раза.

**Итого**: применение двух этапов оптимизации, а также подбор размера кучи позволило увеличить производительность
программы примерно в 8 раз.  
Максимальная производительность достигнута при размерах кучи около 2 Гб.

Результаты замеров сведены в приведённой ниже таблице.  
Первый столбец - размер кучи.  
Второй столбец - временнЫе характеристики работы программы в исходном виде.  
Третий и последующий столбцы - работа программы на определённом этапе оптимизации.  
Во всех столбцах кроме первого указано усреднённое время работы программы на 10 запусках с одинаковыми параметрами.  
Время указано в миллисекундах.
Минимальное значение в столбце выделено жирным.

| Heap |  Integer  |    int   | G1GC -> ParallelGC | ParallelGCThreads=2 | ParallelGCThreads=3 | ParallelGCThreads=4 |
| -----|-----------|----------|---------------------|---------------------|---------------------|---------------------|
|256m  | 27888     | 5031     | 8926                | 8568                | 8384                | 9104                |
|384m  | 24966     | 4820     | 7660                | 7560                | 7204                | 7846                |
|512m  | 19416     | 3701     | 5115                | 4850                | 4776                | 5224                |
|640m  | 19725     | 3640     | 3605                | 3427                | 3413                | 3664                |
|768m  | 18501     | 3706     | 3086                | 3027                | 2984                | 3123                |
|896m  | 18104     | 3340     | 2275                | 2443                | 2359                | 2280                |
|1024m | 17903     | 3412     | 2203                | 2398                | 2319                | 2210                |
|1152m | 17292     | 3458     | 1944                | 2059                | 2005                | 1954                |
|1280m | 17136     | 3333     | 2066                | 2232                | 2154                | 2073                |
|1408m | 16882     | 3421     | 1943                | 2080                | 2004                | 1944                |
|1536m | 16414     | 3044     | 1818                | 1882                | 1847                | 1816                |
|1664m | 15988     | 3238     | 1791                | 1858                | 1823                | 1789                |
|1792m | **14557** | 3187     | 1770                | 1811                | 1790                | 1770                |
|1920m | 15375     | 3086     | **1752**            | **1784**            | **1769**            | **1752**            |
|2048m | 15898     | **3024** | 2025                | 2182                | 2111                | 2028                |
